<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <form class="needs-validation" [formGroup]="formFields">
        <div class="form-row">
          <div class="card w-100">
            <div class="card-header card-header-main">
              <h5 class="text-center"><b><i class="fa fa-fw fa-address-card-o"></i>Comprar ingresso</b></h5>
            </div>

            <!-- TELA 1 -->
            <div class="card-body" *ngIf="step == 1">
              <div class="card flex-row flex-wrap">
                <div class="card-header border-0 card-header-list">
                    <img src="{{ event.featuredImage }}" alt="{{ event.name }}" class="rounded card-img-list">
                </div>
                <div class="card-block px-2 card-body">
                    <h4 class="card-title">{{event.name}}</h4>
                    <p class="card-text card-text-list">Dia {{event.date | date:'dd/MM/yyyy'}} <br /> Horário {{event.timeBegin}} às {{event.timeEnd}}</p>
                    <p class="card-text card-text-list"></p>
                    <span class="badge badge-success">{{event.classification}}</span>
                </div>
              </div>
              
              <br />

              <div *ngFor="let sector of event.sectors">
                <h5 class="text-center card-text-list">{{ sector.name }}</h5>
                <div class="row" *ngFor="let type of sector.ticketTypes">
                  <div class="col-sm-2">
                    <div class="input-group input-group-sm mb-3">
                      <div class="input-group-prepend">
                        <button class="btn btn-primary btn-sm" type="button" (click)="onDecrease(type)"><span class="fa fa-fw fa-minus"></span></button>
                      </div>
                      <input type="number" class="form-control" [(ngModel)]="type.amount" (ngModelChange)="onChangeValues(type)" [ngModelOptions]="{standalone: true}" aria-describedby="basic-addon1">
                      <div class="input-group-append">
                        <button class="btn btn-primary btn-sm" type="button" (click)="onIncrease(type)"><span class="fa fa-fw fa-plus"></span></button>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-7">
                    <span><b> {{ type.name }} </b></span>
                  </div>
                  <div class="col-sm-3 text-right">
                      <span class="text-right">{{ type.total | currency:"R$":0 }} </span>
                  </div>
                </div>
                <hr />
              </div>
              <p class="card-text text-right"><b>Total:</b> <span class="sale-total">{{ cardTransaction.total | currency:"R$":0 }}</span></p>
            </div>

            <!-- TELA 2 -->
            <div class="card-body" *ngIf="step == 2">
              <h5 class="card-title card-text-list">Dados da compra</h5>
              <table class="table table-striped table-hover">
                <tbody>
                  <tr *ngFor="let voucher of ticketSaleEntity.vouchers">
                    <th scope="row">{{ voucher.amount }} x {{ voucher.sector.name }} | {{ voucher.ticketType.name }} </th>
                    <td class="text-right">{{ (voucher.ticketType.total * voucher.amount) | currency:"R$":0}}</td>
                  </tr>
                </tbody>
              </table>
              
              <hr />
              <p class="card-text text-right"><b>Total:</b> <span class="sale-total">{{ cardTransaction.total | currency:"R$":0 }}</span></p>
              
              <hr />
              <h5 class="card-title card-text-list">Meus dados</h5>
              
              <!-- Documento -->
              <div class="form-group col-sm-12 col-md-3 float-left" [ngClass]="applyCssError('document')">
                <small class="form-text text-muted"><b>Documento</b></small>
                <div class="input-group mb-3">
                  <div class="input-group-addon">
                    <i class="fa fa-edit"></i>
                  </div>
                  <input class="form-control" autofocus formControlName="document" placeholder="Documento" maxlength="20"
                    [(ngModel)]="buyerInfo.document" [ngClass]="applyCssError('document')"/>
                </div>
                <app-field-control-error [showError]="verifyValidTouched('document')" errorMessage="Documento é Obrigatório" class="fixErrorPosition"></app-field-control-error>
              </div>

              <!-- CEP -->
              <div class="form-group col-sm-12 col-md-2 float-left" [ngClass]="applyCssError('zipCode')">
                <small class="form-text text-muted"><b>CEP</b></small>
                <div class="input-group mb-3">
                  <div class="input-group-addon">
                    <i class="fa fa-edit"></i>
                  </div>
                  <input class="form-control" autofocus formControlName="zipCode" placeholder="CEP" maxlength="12"
                    [(ngModel)]="buyerInfo.zipCode" [ngClass]="applyCssError('zipCode')"/>
                </div>
                <app-field-control-error [showError]="verifyValidTouched('zipCode')" errorMessage="CEP é Obrigatório" class="fixErrorPosition"></app-field-control-error>
              </div>

              <!-- Endereço -->
              <div class="form-group col-sm-12 col-md-7 float-left" [ngClass]="applyCssError('address')">
                <small class="form-text text-muted"><b>Endereço</b></small>
                <div class="input-group mb-3">
                  <div class="input-group-addon">
                    <i class="fa fa-edit"></i>
                  </div>
                  <input class="form-control" autofocus formControlName="address" placeholder="Endereço" maxlength="300"
                    [(ngModel)]="buyerInfo.address" [ngClass]="applyCssError('address')"/>
                </div>
                <app-field-control-error [showError]="verifyValidTouched('address')" errorMessage="Endereço é Obrigatório" class="fixErrorPosition"></app-field-control-error>
              </div>

              <h5 class="card-title card-text-list">Forma de Pagamento</h5>

              <!-- Identificador -->
              <div class="form-group col-sm-12 col-md-3 float-left" [ngClass]="applyCssError('identifier')">
                <small class="form-text text-muted"><b>Identificador</b></small>
                <div class="input-group mb-3">
                  <div class="input-group-addon">
                    <i class="fa fa-edit"></i>
                  </div>
                  <input class="form-control" formControlName="identifier" placeholder="Identificador" maxlength="255"
                    [(ngModel)]="cardTransaction.identifier" [ngClass]="applyCssError('identifier')"/>
                </div>
              </div>
            </div>
            <div class="card-footer">
              <button class="btn btn-success btn-block" (click)="onChangeStep()">{{ buttonText }}</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  